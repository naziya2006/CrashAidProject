<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ hospital.name }} | Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family:'Poppins', sans-serif; background:linear-gradient(120deg,#84fab0,#8fd3f4); min-height:100vh; }
        .navbar { background:linear-gradient(90deg,#ff416c,#ff4b2b); box-shadow:0 4px 15px rgba(0,0,0,0.2); }
        .navbar-brand { color:#fff !important; font-weight:700; }
        .header-box { text-align:center; margin:40px 0; color:#fff; }
        .card { border:none; border-radius:20px; box-shadow:0 10px 25px rgba(0,0,0,0.15); transition:transform 0.3s ease; }
        .card:hover { transform:translateY(-8px); }
        .badge-low { background:#28a745; }
        .badge-medium { background:#ffc107; color:#000; }
        .badge-high { background:#dc3545; }
        .badge-critical { background:#6f42c1; }
        .btn-handle { border:none; border-radius:20px; padding:5px 15px; font-weight:600; cursor:pointer; }
        .btn-handle:hover { opacity:0.9; }
    </style>
    <script>
        function markHandled(hospitalId, accidentId){
            fetch(`/hospitalapp/${hospitalId}/alerts/${accidentId}/handle/`, {method:'POST', headers:{'X-CSRFToken':'{{ csrf_token }}'}})
            .then(response => response.json()).then(data=>{ location.reload(); });
        }

        setInterval(function(){ location.reload(); }, 10000); // auto-refresh every 10 sec
    </script>
</head>
<body>
<nav class="navbar navbar-expand-lg">
    <div class="container">
        <a class="navbar-brand" href="#">üè• {{ hospital.name }} Dashboard</a>
    </div>
</nav>

<div class="container mt-5">
    <div class="header-box">
    <h2>üö® Latest Accidents</h2>
    <p>Live monitoring of nearest accidents</p>
</div>

<div class="row">
    {% for accident in accidents %}
    <div class="col-md-4 mb-4">
        <div class="card p-3">
            <h5>{{ accident.location }}</h5>

            {% if accident.severity == "Low" %}
                <span class="badge badge-low">Low</span>
            {% elif accident.severity == "Medium" %}
                <span class="badge badge-medium">Medium</span>
            {% elif accident.severity == "High" %}
                <span class="badge badge-high">High</span>
            {% else %}
                <span class="badge badge-critical">Critical</span>
            {% endif %}

            <hr>
            <p>üïí {{ accident.time }}</p>
        </div>
    </div>
    {% empty %}
    <p>No accidents reported yet.</p>
    {% endfor %}
</div>

</div>
</body>
</html>
